<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Permitting Pathway</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #93c5fd 0%, #7dd3fc 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            color: #3b82f6;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            color: #666;
            font-weight: 400;
        }

        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            margin-bottom: 30px;
        }

        .progress-fill {
            height: 100%;
            background: white;
            border-radius: 10px;
            width: 0;
            transition: width 0.4s ease;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .content {
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            min-height: 400px;
        }

        .breadcrumb {
            background: #f0f9ff;
            padding: 16px 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            font-size: 0.95rem;
            color: #555;
            border-left: 4px solid #3b82f6;
        }

        .breadcrumb strong {
            color: #3b82f6;
            margin-right: 8px;
        }

        .question-container {
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1a202c;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .code-section {
            display: inline-block;
            background: #3b82f6;
            color: white;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-left: 12px;
            vertical-align: middle;
        }

        .context {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            color: #856404;
            font-size: 0.95rem;
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        button {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            border: none;
            padding: 18px 24px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            color: white;
            text-align: center;
            box-shadow: 0 4px 12px rgba(72, 187, 120, 0.3);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(72, 187, 120, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .result {
            animation: fadeIn 0.4s ease;
        }

        .result h3 {
            font-size: 1.8rem;
            color: #1a202c;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }

        .result p {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #555;
            background: #f0f9ff;
            padding: 24px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }

        .restart-btn {
            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }

        .back-btn {
            background: #f3f4f6;
            border: 2px solid #d1d5db;
            color: #555;
        }

        .back-btn:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .content {
                padding: 24px;
            }
            
            .question {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèõÔ∏è Permitting Pathway</h1>
            <p>Interactive guide to determine required permits and review processes</p>
        </div>

        <div class="content" id="content">
            <!-- Content will be dynamically generated -->
        </div>
    </div>

    <script>
        class ZoningDecisionTool {
            constructor() {
                this.currentStep = 'start';
                this.breadcrumb = [];
                this.stepHistory = ['start'];
                this.totalSteps = 0;
                this.currentStepNumber = 0;
                this.init();
            }

            init() {
                this.renderStep();
            }

            renderStep() {
                const content = document.getElementById('content');
                const stepData = this.getStepData(this.currentStep);
                
                let html = '';
                
                if (this.breadcrumb.length > 0) {
                    html += `<div class="breadcrumb">
                        <strong>Path:</strong> ${this.breadcrumb.join(' ‚Üí ')}
                    </div>`;
                }

                if (stepData.type === 'question') {
                    html += `
                        <div class="question-container">
                            <div class="question">
                                ${stepData.question}
                                ${stepData.codeSection ? `<span class="code-section">${stepData.codeSection}</span>` : ''}
                            </div>
                            ${stepData.context ? `<div class="context">${stepData.context}</div>` : ''}
                            <div class="button-group">
                                ${stepData.options.map(option => 
                                    `<button onclick="tool.handleAnswer('${option.value}')">${option.text}</button>`
                                ).join('')}
                            </div>
                            ${this.stepHistory.length > 1 ? `
                                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                                    <button class="back-btn" onclick="tool.goBack()">‚Üê Back</button>
                                </div>
                            ` : ''}
                        </div>
                    `;
                } else if (stepData.type === 'result') {
                    html += `
                        <div class="result">
                            <h3>
                                üéØ ${stepData.title}
                                ${stepData.codeSection ? `<span class="code-section">${stepData.codeSection}</span>` : ''}
                            </h3>
                            <p>${stepData.description}</p>
                            <div style="display: flex; gap: 15px; margin-top: 20px;">
                                <button class="restart-btn" onclick="tool.restart()">üîÑ Start Over</button>
                                ${this.stepHistory.length > 1 ? `
                                    <button class="back-btn" onclick="tool.goBack()">‚Üê Back</button>
                                ` : ''}
                            </div>
                        </div>
                    `;
                }

                content.innerHTML = html;
            }

            handleAnswer(value) {
                const stepData = this.getStepData(this.currentStep);
                const selectedOption = stepData.options.find(opt => opt.value === value);
                
                if (selectedOption) {
                    this.breadcrumb.push(selectedOption.text);
                    this.currentStep = selectedOption.next;
                    this.stepHistory.push(this.currentStep);
                    this.currentStepNumber++;
                    this.renderStep();
                }
            }

            goBack() {
                if (this.stepHistory.length > 1) {
                    this.stepHistory.pop();
                    this.currentStep = this.stepHistory[this.stepHistory.length - 1];
                    this.breadcrumb.pop();
                    this.currentStepNumber = Math.max(0, this.currentStepNumber - 1);
                    this.renderStep();
                }
            }

            restart() {
                this.currentStep = 'start';
                this.breadcrumb = [];
                this.stepHistory = ['start'];
                this.currentStepNumber = 0;
                this.renderStep();
            }

            getStepData(step) {
                const steps = {
                    'start': {
                        type: 'question',
                        question: 'Is the use allowed in this zone?',
                        context: 'Check if use table shows anything other than "Not Permitted"',
                        options: [
                            { text: 'Yes - Use is allowed in some form', value: 'check_accessory', next: 'check_accessory' },
                            { text: 'No - Shows "Not Permitted"', value: 'not_permitted', next: 'not_permitted' }
                        ]
                    },

                    'not_permitted': {
                        type: 'result',
                        title: 'Use Not Permitted',
                        description: 'The City\'s General Plan and zoning ordinance do not permit this use in that zone. You would need to pursue a General Plan amendment and/or zone change, which is a separate legislative process.'
                    },

                    'check_accessory': {
                        type: 'question',
                        question: 'Is this an accessory use?',
                        context: 'Does the use table show "A" (Accessory use)?',
                        options: [
                            { text: 'Yes - Accessory use', value: 'accessory_check', next: 'accessory_check' },
                            { text: 'No - Not accessory', value: 'check_standards', next: 'check_standards' }
                        ]
                    },

                    'accessory_check': {
                        type: 'question',
                        question: 'Can use be demonstrated as secondary to primary use?',
                        options: [
                            { text: 'Yes - Secondary to primary use', value: 'administrative', next: 'administrative' },
                            { text: 'No - Cannot demonstrate secondary relationship', value: 'not_permitted', next: 'not_permitted' }
                        ]
                    },

                    'check_standards': {
                        type: 'question',
                        question: 'Does development meet ALL zoning standards?',
                        context: 'Setbacks, height, parking, lot coverage, etc.',
                        options: [
                            { text: 'Yes - Meets all standards', value: 'check_use_type', next: 'check_use_type' },
                            { text: 'No - Does not meet standards', value: 'check_variance', next: 'check_variance' }
                        ]
                    },

                    'check_variance': {
                        type: 'question',
                        question: 'Are there exceptional property conditions?',
                        context: 'Exceptional narrowness, shallowness, or unusual shape',
                        options: [
                            { text: 'Yes - Exceptional property conditions', value: 'variance', next: 'variance' },
                            { text: 'No - Standard property conditions', value: 'not_permitted', next: 'not_permitted' }
                        ]
                    },

                    'check_use_type': {
                        type: 'question',
                        question: 'What does the use table show?',
                        options: [
                            { text: 'P - Permitted', value: 'check_spar', next: 'check_spar' },
                            { text: 'CUP - Conditional Use Permit', value: 'cup', next: 'cup' },
                            { text: 'S - Specific Use Regulations', value: 'check_chapter7', next: 'check_chapter7' }
                        ]
                    },

                    'check_chapter7': {
                        type: 'question',
                        question: 'Does the use meet all standards outlined in Chapter 7?',
                        context: 'Check the specific use regulations referenced in the use table. Use the Zoning Lookup Tool to find detailed Chapter 7 requirements for your specific use.',
                        options: [
                            { text: 'Yes - Meets all Chapter 7 standards', value: 'specific_regs_compliant', next: 'specific_regs_compliant' },
                            { text: 'No - Does not meet standards', value: 'zoning_compliance_required', next: 'zoning_compliance_required' }
                        ]
                    },

                    'check_spar': {
                        type: 'question',
                        question: 'Does this project require SPAR?',
                        codeSection: 'Section 24.050',
                        context: 'Is use specifically listed in Section 24.050.A? (Public buildings, schools, hospitals, churches, clubs, motels, offices, commercial, industrial, mobile home parks, parking lots, utilities, multi-family, subdivision resulting in 5 or more parcels)',
                        options: [
                            { text: 'Yes - Listed in 24.050.A', value: 'spar_type', next: 'spar_type' },
                            { text: 'No - Not listed', value: 'permitted_no_spar', next: 'permitted_no_spar' }
                        ]
                    },

                    'permitted_no_spar': {
                        type: 'result',
                        title: 'Permitted by Right - No Planning Permit Required',
                        description: 'This use is permitted by right and does not require SPAR or other planning permits. You may proceed with building permits or other ministerial approvals as needed.'
                    },

                    'spar_type': {
                        type: 'question',
                        question: 'What type of SPAR is required?',
                        codeSection: 'Section 24.050',
                        options: [
                            { text: 'Nonproduction residential in approved subdivision (‚â•5 lots)', value: 'admin_spar', next: 'admin_spar' },
                            { text: 'Residential development <5 units', value: 'admin_spar', next: 'admin_spar' },
                            { text: 'Minor addition to commercial/industrial/office', value: 'admin_spar_option', next: 'admin_spar_option' },
                            { text: 'Other SPAR-required project', value: 'pc_spar', next: 'pc_spar' }
                        ]
                    },

                    'admin_spar_option': {
                        type: 'question',
                        question: 'Does Director choose to handle administratively?',
                        options: [
                            { text: 'Yes - Administrative review', value: 'admin_spar', next: 'admin_spar' },
                            { text: 'No - Planning Commission review', value: 'pc_spar', next: 'pc_spar' }
                        ]
                    },

                    'admin_spar': {
                        type: 'result',
                        title: 'Administrative SPAR Required',
                        codeSection: 'Section 24.050',
                        description: 'This project requires Site Plan and Architectural Review by the Director. This is a discretionary review with required findings, but no public hearing is required.'
                    },

                    'pc_spar': {
                        type: 'result',
                        title: 'Planning Commission SPAR Required',
                        codeSection: 'Section 24.050',
                        description: 'This project requires Site Plan and Architectural Review by the Planning Commission. This involves a public hearing with discretionary findings and public notice requirements.'
                    },

                    'cup': {
                        type: 'question',
                        question: 'What type of Conditional Use Permit is needed?',
                        codeSection: 'Section 24.060',
                        options: [
                            { text: 'Minor modification to existing CUP', value: 'minor_cup', next: 'minor_cup' },
                            { text: 'Less intensive use than previous occupant', value: 'minor_cup', next: 'minor_cup' },
                            { text: 'Dwelling group (multiple detached units)', value: 'minor_cup', next: 'minor_cup' },
                            { text: 'Tasting room', value: 'minor_cup', next: 'minor_cup' },
                            { text: 'Single-family home in commercial zone', value: 'minor_cup', next: 'minor_cup' },
                            { text: 'Minor telecommunications facility', value: 'minor_cup', next: 'minor_cup' },
                            { text: 'Recently expired CUP (within 24 months)', value: 'minor_cup', next: 'minor_cup' },
                            { text: 'Standard conditional use', value: 'standard_cup', next: 'standard_cup' }
                        ]
                    },

                    'minor_cup': {
                        type: 'result',
                        title: 'Minor Use Permit Required',
                        codeSection: 'Section 24.060',
                        description: 'This project qualifies for a Minor Use Permit, which can be approved administratively by the Director. Same findings as standard CUP but no public hearing required.'
                    },

                    'standard_cup': {
                        type: 'result',
                        title: 'Standard Conditional Use Permit Required',
                        codeSection: 'Section 24.060',
                        description: 'This project requires a standard Conditional Use Permit reviewed by the Planning Commission. This involves a public hearing with required findings and public notice requirements.'
                    },

                    'variance': {
                        type: 'question',
                        question: 'What type of variance review?',
                        codeSection: 'Section 24.070',
                        context: 'All required findings must be met: peculiar property conditions, hardship not created by owner, necessary for substantial property rights, no detriment to adjacent properties',
                        options: [
                            { text: 'Director chooses administrative review', value: 'admin_variance', next: 'admin_variance' },
                            { text: 'Planning Commission review', value: 'pc_variance', next: 'pc_variance' }
                        ]
                    },

                    'admin_variance': {
                        type: 'result',
                        title: 'Administrative Variance',
                        codeSection: 'Section 24.070',
                        description: 'This variance can be reviewed administratively by the Director. All variance findings must still be met, but no public hearing is required.'
                    },

                    'pc_variance': {
                        type: 'result',
                        title: 'Planning Commission Variance',
                        codeSection: 'Section 24.070',
                        description: 'This variance requires Planning Commission review with a public hearing. All required variance findings must be met with substantial evidence.'
                    },

                    'specific_regs_compliant': {
                        type: 'result',
                        title: 'Specific Use Regulations - Compliant',
                        description: 'This use meets the specific use regulations in Chapter 7. Since it complies with all standards, no additional planning permits are required. You may proceed with building permits or other ministerial approvals as needed.'
                    },

                    'zoning_compliance_required': {
                        type: 'result',
                        title: 'Zoning Compliance Required First',
                        description: 'This use must comply with specific use regulations in Chapter 7 before proceeding. Use the Zoning Lookup Tool to find the detailed requirements for your specific use, then work with planning staff to achieve compliance.'
                    },

                    'administrative': {
                        type: 'question',
                        question: 'What type of administrative permit?',
                        codeSection: 'Section 24.030',
                        options: [
                            { text: 'Business license', value: 'business_license', next: 'business_license' },
                            { text: 'Home occupation permit', value: 'home_occupation', next: 'home_occupation' },
                            { text: 'Short-term vacation rental', value: 'str_permit', next: 'str_permit' },
                            { text: 'State housing law (SB 9, etc.)', value: 'state_housing', next: 'state_housing' },
                            { text: 'Other ministerial permit', value: 'other_ministerial', next: 'other_ministerial' }
                        ]
                    },

                    'business_license': {
                        type: 'result',
                        title: 'Business License Required',
                        description: 'Business license review process (handled by Finance Department). Zoning compliance must be verified first.'
                    },

                    'home_occupation': {
                        type: 'result',
                        title: 'Home Occupation Permit Required',
                        description: 'Home occupation permit review process. Must meet Section 7.060 compliance standards.'
                    },

                    'str_permit': {
                        type: 'result',
                        title: 'Short-Term Vacation Rental Permit',
                        description: 'STR permit review process. Must meet Section 7.110 requirements including business license and transient occupancy tax certificate.'
                    },

                    'state_housing': {
                        type: 'result',
                        title: 'State Housing Law - Ministerial Approval',
                        description: 'Ministerial approval per state law (SB 9 or other qualifying legislation). Must meet objective standards as defined by state law.'
                    },

                    'other_ministerial': {
                        type: 'result',
                        title: 'Other Ministerial Permit',
                        description: 'Administrative determination based on objective standards. No discretionary findings required.'
                    }
                };

                if (this.totalSteps === 0) {
                    this.totalSteps = Object.keys(steps).filter(key => steps[key].type === 'question').length;
                }

                return steps[step] || steps['start'];
            }
        }

        const tool = new ZoningDecisionTool();
    </script>
</body>
</html>
